var longitude=document.getElementById("longitude").value;var latitude=document.getElementById("latitude").value;var title=document.getElementById("stitle").value;var content=document.getElementById("scontent").value;function initMap(){createMap();setMapEvent();addMapControl();addMarker()}function createMap(){var b=new BMap.Map("dituContent");var a=new BMap.Point(longitude,latitude);b.centerAndZoom(a,17);window.map=b}function setMapEvent(){map.enableDragging();map.enableScrollWheelZoom();map.enableDoubleClickZoom();map.enableKeyboard()}function addMapControl(){var b=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});map.addControl(b);var a=new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:0});map.addControl(a);var c=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});map.addControl(c)}var markerArr=[{title:title,content:content,point:longitude+"|"+latitude,isOpen:0,icon:{w:21,h:22,l:45,t:45,x:6,lb:5}}];function addMarker(){for(var c=0;c<markerArr.length;c++){var j=markerArr[c];var h=j.point.split("|")[0];var g=j.point.split("|")[1];var f=new BMap.Point(h,g);var b=createIcon(j.icon);var d=new BMap.Marker(f,{icon:b});var a=createInfoWindow(c);var e=new BMap.Label(j.title,{offset:new BMap.Size(j.icon.lb-j.icon.x+20,-20)});d.setLabel(e);map.addOverlay(d);e.setStyle({width:"300px",height:"30px",borderColor:"#808080",color:"#ff0000",font:"18px",cursor:"pointer"});(function(){var i=c;var l=createInfoWindow(c);var k=d;k.addEventListener("click",function(){this.openInfoWindow(l)});l.addEventListener("open",function(){k.getLabel().hide()});l.addEventListener("close",function(){k.getLabel().show()});e.addEventListener("click",function(){k.openInfoWindow(l)});if(!!j.isOpen){e.hide();k.openInfoWindow(l)}})()}}function createInfoWindow(c){var b=markerArr[c];var a=new BMap.InfoWindow("<b class='iw_poi_title' title='"+b.title+"'>"+b.title+"</b><div class='iw_poi_content'>"+b.content+"</div>");return a}function createIcon(a){var b=new BMap.Icon("http://app.baidu.com/map/images/us_mk_icon.png",new BMap.Size(a.w,a.h),{imageOffset:new BMap.Size(-a.l,-a.t),infoWindowOffset:new BMap.Size(a.lb+5,1),offset:new BMap.Size(a.x,a.h)});return b}initMap();