var wait=120;function timeWait(a){if(wait==0){a.removeAttr("disabled");a.val("获取验证码");wait=120}else{a.attr("disabled",true);a.val("重新发送("+wait+")");wait--;setTimeout(function(){timeWait(a)},1000)}}$(function(){$("#registrationByEmail").removeClass("tabaction");$("#sendSMS").on("click",function(){var a=true;var e=$("#identifyingCode").val();var f="codeYzm="+e;var c="/valiCode/codeyzm.do";$.ajax({type:"post",url:c,data:f,async:false,success:function(g){if(g=="success"){a=true}else{alert("验证码错误,请输入正确的验证码");a=false}},error:function(g){a=false}});if(!a){return}var b=$("#phoneNum").val();var d=$(this).attr("disabled",true);$.ajax({async:true,type:"POST",url:"/sendSMSCaptcha.do",data:{phone:b},success:function(g){if(g=="0000"){timeWait(d)}else{if(g=="0001"){alert("手机号码格式错误！")}else{alert("发送短信异常！")}d.removeAttr("disabled")}}})});$("#phoneNum").blur(function(){$("#phoneNum").next().remove();$("#phoneNum").attr("class","inputkk");var b=$('<label class="one1" style="width:180px;">请输入手机号码</label>');var c=$("#phoneNum").val().trim();var a=/^(?:13\d|15\d|17\d|18\d)\d{5}(\d{3}|\*{3})$/;if(c==""){$("#phoneNum").after(b);$("#phoneNum").attr("class","inputkkred")}else{if(!a.test($("#phoneNum").val())){str="请输入正确的手机号";b=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#phoneNum").after(b);$("#phoneNum").attr("class","inputkkred")}}});$("#username").blur(function(){$("#username").next().remove();$("#username").attr("class","inputkk");var a=$('<label class="one1" style="width:180px;">请输入用户名</label>');var b=$("#username").val().trim();if(b==""){$("#username").after(a);$("#username").attr("class","inputkkred")}else{if($("#username").val().length>20){a=$('<label class="one1" style="width:180px;">长度不能大于20位！</label>');$("#username").after(a);$("#username").attr("class","inputkkred")}else{if($("#username").val().length<6){a=$('<label class="one1" style="width:180px;">长度不能小于6位！</label>');$("#username").after(a);$("#username").attr("class","inputkkred")}}}});$("#password").blur(function(){$("#password").next().remove();$("#password").attr("class","inputkk");var a=$('<label class="one1" style="width:180px;">请输入密码</label>');var f=$("#password").val().trim();if(f==""){$("#password").after(a);$("#password").attr("class","inputkkred")}else{if($("#password").val().length>20){var a=$('<label class="one1" style="width:180px;">长度不能大于20位</label>');$("#password").after(a);$("#password").attr("class","inputkkred")}else{var a=$('<div class="mimazhuangtai"><ul><li>弱</li><li>中</li><li>强</li><div class="clear"></div></ul></div>');$("#password").after(a);$("#password").attr("class","inputkkred")}}var c=/(?=.*[\d]+)(?=.*[a-zA-Z]+)(?=.*[^a-zA-Z0-9]+).{10,20}/;var b=/(?=.*[a-zA-Z]+)(?=.*[^a-zA-Z0-9]+).{10,20}/;var e=/(?=.*[\d]+)(?=.*[a-zA-Z]+).{10,20}/;var d=/(?=.*[\d]+)(?=.*[^a-zA-Z0-9]+).{10,20}/;if(c.test($("#password").val().trim())){$(".mimazhuangtai ul li").last().addClass("ruored")}else{if(e.test($("#password").val().trim())||d.test($("#password").val().trim())||b.test($("#password").val().trim())){$(".mimazhuangtai ul li").first().next().addClass("ruored")}else{$(".mimazhuangtai ul li").first().addClass("ruored")}}});$("#confirm_password").blur(function(){if($("#confirm_password").val().trim()!=$("#password").val().trim()){$("#confirm_password").next().remove();$("#confirm_password").attr("class","inputkk");var a=$('<label class="one1" style="width:180px;">两次密码不一致</label>');$("#confirm_password").after(a);$("#confirm_password").attr("class","inputkkred")}else{validate(this,"请再次输入密码",20)}});$("#validateCode").blur(function(){validate(this,"请输入验证码",20)});$("#registrationForm").submit(function(){$("#registrationForm label[class=one1]").remove();var a=/^(?:13\d|15\d|17\d|18\d)\d{5}(\d{3}|\*{3})$/;if($("#phoneNum").val().trim()==""){var b=$('<label class="one1" style="width:180px;">请输入手机号码,</label>');$("#phoneNum").after(b);$("#phoneNum").attr("class","inputkkred")}else{if(!a.test($("#phoneNum").val())){var d="请输入正确的手机号";var b=$('<label class="one1" style="width:180px;">'+d+"</label>");$("#phoneNum").after(b);$("#phoneNum").attr("class","inputkkred")}}var b=$('<label class="one1" style="width:180px;">请输入用户名</label>');var c=$("#username").val().trim();if(c==""){$("#username").after(b);$("#username").attr("class","inputkkred")}else{if($("#username").val().length>20){b=$('<label class="one1" style="width:180px;">长度不能大于20位！</label>');$("#username").after(b);$("#username").attr("class","inputkkred")}else{if($("#username").val().length<6){b=$('<label class="one1" style="width:180px;">长度不能小于6位！</label>');$("#username").after(b);$("#username").attr("class","inputkkred")}}}var b=$('<label class="one1" style="width:180px;">请输入密码</label>');var c=$("#password").val().trim();if(c==""){$("#password").after(b);$("#password").attr("class","inputkkred")}else{if($("#password").val().length>20){var b=$('<label class="one1" style="width:180px;">长度不能大于20位</label>');$("#password").after(b);$("#password").attr("class","inputkkred")}}if($("#confirm_password").val().trim()!=$("#password").val().trim()){$("#confirm_password").next().remove();var b=$('<label class="one1" style="width:180px;">两次密码不一致</label>');$("#confirm_password").after(b);$("#confirm_password").attr("class","inputkkred")}else{validate("#confirm_password","请再次输入密码",20)}validate("#validateCode","请输入验证码",20);if($("#registrationForm label[class=one1]").length>0){return false}$("#password").val(md5($("#password").val()));$.ajax({async:false,type:"POST",url:"/account/insertUser.do",data:$(this).serialize(),success:function(e){if(e=="注册成功"){alert("注册成功");window.location.href="/account/login.do"}else{if(e=="codeError"){alert("验证码错误")}else{alert("用户名或手机号码已存在")}}},error:function(f){alert("error");return false}});return false})});function validate(b,e,c){$(b).next().remove();$(b).attr("class","inputkk");var a=$('<label class="one1" style="width:180px;">'+e+"</label>");var d=$(b).val().trim();if(d==""){$(b).after(a);$(b).attr("class","inputkkred")}else{if($(b).val().length>c){e="长度不能大于"+c+"位！";a=$('<label class="one1" style="width:180px;">'+e+"</label>");$(b).after(a);$(b).attr("class","inputkkred")}}};