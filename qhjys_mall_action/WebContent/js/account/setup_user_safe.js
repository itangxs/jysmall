var wait=120;function timeWait(a){if(wait==0){a.attr("disabled","");a.val("获取验证码");wait=120}else{a.attr("disabled",true);a.val("重新发送("+wait+")");wait--;setTimeout(function(){timeWait(a)},1000)}}var sendEmailwait=120;function sendEmailtimeWait(a){if(wait==0){a.attr("disabled","");a.val("发送验证码到邮箱");sendEmailwait=120}else{a.attr("disabled",true);a.val("重新发送("+sendEmailwait+")");sendEmailwait--;setTimeout(function(){sendEmailtimeWait(a)},1000)}}var sendEmail1wait=120;function sendEmail1timeWait(a){if(wait==0){a.attr("disabled","");a.val("发送验证码到旧邮箱");sendEmail1wait=120}else{a.attr("disabled",true);a.val("重新发送("+sendEmail1wait+")");sendEmail1wait--;setTimeout(function(){sendEmail1timeWait(a)},1000)}}var sendEmail2wait=120;function sendEmail2timeWait(a){if(wait==0){a.removeAttr("disabled");a.val("发送验证码到旧邮箱");sendEmail2wait=120}else{a.attr("disabled",true);a.val("重新发送("+sendEmail2wait+")");sendEmail2wait--;setTimeout(function(){sendEmail2timeWait(a)},1000)}}$(function(){$("#sendSMS1").on("click",function(){var a=$("#phoneNum").val();var b=$(this).attr("disabled",true);$.ajax({async:true,type:"POST",url:"/sendSMSCaptcha.do",data:{phone:a},success:function(c){if(c=="0000"){timeWait(b)}else{if(c=="0001"){alert("手机号码格式错误！")}else{alert("发送短信异常！")}b.removeAttr("disabled")}}})});$("#sendSMS2").on("click",function(){var a=$("#nowPhoneNum").val();var b=$(this).attr("disabled",true);$.ajax({async:true,type:"POST",url:"/sendSMSCaptcha.do",data:{phone:a},success:function(c){if(c=="0000"){timeWait(b)}else{if(c=="0001"){alert("手机号码格式错误！")}else{alert("发送短信异常！")}b.removeAttr("disabled")}}})});$("#sendSMS3").on("click",function(){var a=$("#phoneNum1").val();var b=$(this).attr("disabled",true);$.ajax({async:true,type:"POST",url:"/sendNewSMSCaptcha.do",data:{newPhone:a},success:function(c){if(c=="0000"){timeWait(b)}else{if(c=="0001"){alert("手机号码格式错误！")}else{alert("发送短信异常！")}b.removeAttr("disabled")}}})});$("#sendEmail").on("click",function(){$("#email").next().remove();var c=$('<label class="one1" style="width:180px;">请输入邮箱</label>');var e=$("#email").val().trim();var d=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;if(e==""){$("#email").after(c);return false}else{if(!d.test($("#email").val())){str="请输入正确的邮箱";c=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#email").after(c);return false}}var a=$("#email").val();var b=$(this).attr("disabled",true);$.ajax({async:true,type:"POST",url:"/sendRequestEmailCaptcha.do",data:{emailUrl:a},success:function(f){if(f!="succeess"){alert("邮箱发送异常！");return null}else{alert("邮箱发送成功！");sendEmailtimeWait(b)}}})});$("#sendEmail1").on("click",function(){$("#nowEmail").next().remove();var c=$('<label class="one1" style="width:180px;">请输入邮箱</label>');var e=$("#nowEmail").val().trim();var d=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;if(e==""){$("#nowEmail").after(c);return false}else{if(!d.test($("#nowEmail").val())){str="请输入正确的邮箱";c=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#nowEmail").after(c);return false}}var a=$("#nowEmail").val();var b=$(this).attr("disabled",true);$.ajax({async:true,type:"POST",url:"/sendRequestEmailCaptcha.do",data:{emailUrl:a},success:function(f){if(f!="succeess"){alert("邮箱发送异常！");return null}else{alert("邮箱发送成功！");sendEmail1timeWait(b)}}})});$("#sendEmail2").on("click",function(){$("#email1").next().remove();$("#email1").next().remove();var c=$('<label class="one1" style="width:180px;">请输入邮箱</label>');var e=$("#email1").val().trim();var d=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;if(e==""){$("#email1").after(c);return false}else{if(!d.test($("#email1").val())){str="请输入正确的邮箱";c=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#email1").after(c);return false}}var a=$("#email1").val();var b=$(this).attr("disabled",true);$.ajax({async:true,type:"POST",url:"/sendRequestNewEmailCaptcha.do",data:{emailUrl:a},success:function(f){if(f!="succeess"){alert("邮箱发送异常！");return null}else{alert("邮箱发送成功！");sendEmail2timeWait(b)}}})});$("#nowPassword").blur(function(){validate(this,"请输入当前密码",20)});$("#password").blur(function(){validate(this,"请输入密码",20)});$("#validateCode").blur(function(){validate(this,"请输入动态码",20)});$("#validateCode1").blur(function(){validate(this,"请输入动态码",20)});$("#newValidateCode").blur(function(){validate(this,"请输入动态码",20)});$("#phoneNum").blur(function(){$("#phoneNum").next().remove();var b=$('<label class="one1" style="width:180px;">请输入手机号码</label>');var c=$("#phoneNum").val().trim();var a=/^(?:13\d|15\d|17\d|18\d)\d{5}(\d{3}|\*{3})$/;if(c==""){$("#phoneNum").after(b)}else{if(!a.test($("#phoneNum").val())){str="请输入正确的手机号";b=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#phoneNum").after(b)}}});$("#phoneNum1").blur(function(){$("#phoneNum1").next().remove();var b=$('<label class="one1" style="width:180px;">请输入手机号码</label>');var c=$("#phoneNum1").val().trim();var a=/^(?:13\d|15\d|17\d|18\d)\d{5}(\d{3}|\*{3})$/;if(c==""){$("#phoneNum1").after(b)}else{if(!a.test($("#phoneNum1").val())){str="请输入正确的手机号";b=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#phoneNum1").after(b)}}});$("#validateCode").blur(function(){validate(this,"请输入动态码",20)});$("#nowPhoneNum").blur(function(){validate(this,"请输入手机号",20)});$("#newValidateCode").blur(function(){validate(this,"请输入动态码",20)});$("#confirm_password").blur(function(){if($("#confirm_password").val().trim()!=$("#password").val().trim()){$("#confirm_password").next().remove();var a=$('<label class="one1" style="width:180px;">两次密码不一致</label>');$("#confirm_password").after(a)}else{validate(this,"请再次输入密码",20)}});$("#email").blur(function(){$("#email").next().remove();var a=$('<label class="one1" style="width:180px;">请输入邮箱</label>');var c=$("#email").val().trim();var b=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;if(c==""){$("#email").after(a)}else{if(!b.test($("#email").val())){str="请输入正确的邮箱";a=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#email").after(a)}}});$("#emailValidateCode").blur(function(){validate(this,"请输入验证码",20)});$("#emailValidateCode1").blur(function(){validate(this,"请输入验证码",20)});$("#email1").blur(function(){$("#email1").next().remove();var a=$('<label class="one1" style="width:180px;">请输入邮箱</label>');var c=$("#email1").val().trim();var b=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;if(c==""){$("#email1").after(a)}else{if(!b.test($("#email1").val())){str="请输入正确的邮箱";a=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#email1").after(a)}}});$("#nowEmailValidateCode").blur(function(){validate(this,"请输入验证码",20)});$("#payCode").blur(function(){validate(this,"请输入支付密码",20)});$("#confirm_payCode").blur(function(){if($("#confirm_payCode").val().trim()!=$("#payCode").val().trim()){$("#confirm_payCode").next().remove();var a=$('<label class="one1" style="width:180px;">两次密码不一致</label>');$("#confirm_payCode").after(a)}else{validate(this,"请再次输入支付密码",20)}});$("#payCode1").blur(function(){validate(this,"请输入新支付密码",20)});$("#confirm_payCode1").blur(function(){if($("#confirm_payCode1").val().trim()!=$("#payCode1").val().trim()){$("#confirm_payCode1").next().remove();var a=$('<label class="one1" style="width:180px;">两次密码不一致</label>');$("#confirm_payCode1").after(a)}else{validate(this,"请再次输入新支付密码",20)}});$("#question").blur(function(){validate(this,"请输入密保问题",20)});$("#answer").blur(function(){validate(this,"请输入密保答案",20)});$("#realname").blur(function(){validate(this,"请输入真实姓名",20)});$("#cardId").blur(function(){$("#cardId").next().remove();var a=$('<label class="one1" style="width:180px;">请输入身份证号码</label>');var b=$("#cardId").val().trim();if(b==""){$("#cardId").after(a)}else{if(isNaN($("#cardId").val())||$("#cardId").val().length!=18){str="请输入正确的身份证号码";a=$('<label class="one1" style="width:180px;">'+str+"</label>");$("#cardId").after(a)}}});$("#setupPasswordForm").submit(function(){$("#setupPasswordForm label[class=one1]").remove();validate("#nowPassword","请输入当前密码",20);validate("#password","请输入密码",20);validate("#confirm_password","请再次输入密码",20);if($("#confirm_password").val().trim()!=$("#password").val().trim()){$("#confirm_password").next().remove();var a=$('<label class="one1" style="width:180px;">两次密码不一致</label>');$("#confirm_password").after(a)}if($("#setupPasswordForm label[class=one1]").length>0){return false}$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:{nowPassword:md5($("#nowPassword").val()),password:md5($("#password").val())},success:function(b){if(b=="修改成功"){alert("修改密码成功");window.location.href="/managermall/account/setupUserSafe.do"}else{if(b=="当前密码错误"){alert(b)}else{alert("修改密码失败")}}},error:function(b){alert("error");return false}});return false});$("#setTelFrom").submit(function(){$("#setTelFrom label[class=one1]").remove();validate("#phoneNum","请输入手机号",20);validate("#validateCode","请输入动态码",20);if($("#setTelFrom label[class=one1]").length>0){return false}$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:$(this).serialize(),success:function(a){if(a=="修改成功"){alert("绑定手机号成功");window.location.href="/managermall/account/setupUserSafe.do"}else{if(a=="codeError"){alert("验证码错误")}else{alert("用户名或手机号码已存在")}}},error:function(a){alert("error");return false}});return false});$("#updateTelFrom").submit(function(){$("#updateTelFrom label[class=one1]").remove();var a=/^(?:13\d|15\d|17\d|18\d)\d{5}(\d{3}|\*{3})$/;if($("#phoneNum1").val().trim()==""){var b=$('<label class="one1" style="width:180px;">请输入手机号码</label>');$("#phoneNum1").after(b)}else{if(!a.test($("#phoneNum1").val())){var c="请输入正确的手机号";var b=$('<label class="one1" style="width:180px;">'+c+"</label>");$("#phoneNum1").after(b)}}validate("#validateCode1","请再次输入密码",20);validate("#newValidateCode","请再次输入密码",20);if($("#updateTelFrom label[class=one1]").length>0){return false}$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:$(this).serialize(),success:function(d){if(d=="修改成功"){alert("绑定手机号成功");window.location.href="/managermall/account/setupUserSafe.do"}else{if(d=="codeError"){alert("验证码错误")}else{alert("用户名或手机号码已存在")}}},error:function(d){alert("error");return false}});return false});$("#setEmailFrom").submit(function(){$("#setEmailFrom label[class=one1]").remove();var b=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;if($("#email").val().trim()==""){var a=$('<label class="one1" style="width:180px;">请输入邮箱</label>');$("#email").after(a)}else{if(!b.test($("#email").val())){var c="请输入正确的邮箱";var a=$('<label class="one1" style="width:180px;">'+c+"</label>");$("#email").after(a)}}validate("#emailValidateCode","请输入验证码",20);if($("#setEmailFrom label[class=one1]").length>0){return false}$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:$(this).serialize(),success:function(d){if(d=="修改成功"){alert("添加邮箱成功");window.location.href="/managermall/account/setupUserSafe.do"}else{alert(d)}},error:function(d){alert("error");return false}});return false});$("#updateEmailFrom").submit(function(){$("#updateEmailFrom label[class=one1]").remove();validate("#emailValidateCode1","请输入验证码",20);var b=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;if($("#email1").val().trim()==""){var a=$('<label class="one1" style="width:180px;">请输入邮箱</label>');$("#email1").after(a)}else{if(!b.test($("#email1").val())){var c="请输入正确的邮箱";var a=$('<label class="one1" style="width:180px;">'+c+"</label>");$("#email1").after(a)}}validate("#nowEmailValidateCode","请输入验证码",20);if($("#updateEmailFrom label[class=one1]").length>0){return false}$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:$(this).serialize(),success:function(d){if(d=="修改成功"){alert("修改邮箱成功");window.location.href="/managermall/account/setupUserSafe.do"}else{alert(d)}},error:function(d){alert("error");return false}});return false});$("#setupPayCodeForm").submit(function(){$("#setupPayCodeForm label[class=one1]").remove();var a=$('<label class="one1" style="width:180px;">请输入支付密码</label>');var b=$("#payCode").val().trim();if(b==""){$("#payCode").after(a)}else{if($("#payCode").val().length>20){var a=$('<label class="one1" style="width:180px;">长度不能大于20位</label>');$("#payCode").after(a)}}if($("#confirm_payCode").val().trim()!=$("#payCode").val().trim()){$("#confirm_payCode").next().remove();var a=$('<label class="one1" style="width:180px;">两次密码不一致</label>');$("#confirm_payCode").after(a)}else{validate("#confirm_payCode","请再次输入支付密码",20)}if($("#setupPayCodeForm label[class=one1]").length>0){return false}$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:{nowPayCode:md5($("#nowPayCode").val()),payCode:md5($("#payCode").val())},success:function(c){if(c=="修改成功"){alert("添加支付密码成功");window.location.href="/managermall/account/setupUserSafe.do"}else{alert("添加支付密码失败")}},error:function(c){alert("error");return false}});return false});$("#updatePayCodeForm").submit(function(){$("#updatePayCodeForm label[class=one1]").remove();var b=$('<label class="one1" style="width:180px;">请输入新支付密码</label>');var c=$("#payCode1").val().trim();if(c==""){$("#payCode1").after(b)}else{if($("#payCode1").val().length>20){var b=$('<label class="one1" style="width:180px;">长度不能大于20位</label>');$("#payCode1").after(b)}}if($("#confirm_payCode1").val().trim()!=$("#payCode1").val().trim()){$("#confirm_payCode1").next().remove();var b=$('<label class="one1" style="width:180px;">两次密码不一致</label>');$("#confirm_payCode1").after(b)}else{validate("#confirm_payCode1","请再次输入新支付密码",20)}if($("#updatePayCodeForm label[class=one1]").length>0){return false}var a=md5($("#payCode1").val());$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:{nowPayCode:md5($("#nowPayCode").val()),payCode:a},success:function(d){if(d=="修改成功"){alert("修改支付密码成功");window.location.href="/managermall/account/setupUserSafe.do"}else{alert("旧支付密码错误")}},error:function(d){alert("error");return false}});return false});$("#setupQuestionForm").submit(function(){$("#setupQuestionForm label[class=one1]").remove();validate("#validateCode","请输入密保问题",20);validate("#validateCode","请输入密保答案",20);if($("#setupQuestionForm label[class=one1]").length>0){return false}$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:$(this).serialize(),success:function(a){if(a=="修改成功"){alert("设置安全问题成功");window.location.href="/managermall/account/setupUserSafe.do"}else{alert("设置安全问题失败")}},error:function(a){alert("error");return false}});return false});$("#setCertifiedForm").submit(function(){$("#setCertifiedForm label[class=one1]").remove();validate("#realname","请输入真实姓名",20);validate("#cardId","请输入身份证号码",18);if($("#setCertifiedForm label[class=one1]").length>0){return false}$.ajax({async:false,type:"POST",url:"/managermall/account/setupAccount.do",data:$(this).serialize(),success:function(a){if(a=="修改成功"){alert("设置实名认证成功");window.location.href="/managermall/account/setupUserSafe.do"}else{if(a=="身份证号码已存在"){alert(a)}else{alert("设置实名认证失败")}}},error:function(a){alert("error");return false}});return false})});function setupPassword(){$("#setPassword").show()}function setTel(){$("#setTel").show()}function updateTel(){$("#updateTel").show()}function setEmail(){$("#setEmail").show()}function updateEmail(){$("#updateEmail").show()}function setPayCode(){$("#setPayCode").show()}function updatePayCode(){$("#updatePayCode").show()}function setQuestion(){$("#setQuestion").show()}function setCertified(){$("#setCertified").show()}function closeWindow(){$(".member_tanchubangding").hide();$("label[class=one1]").remove();$("#setTelFrom")[0].reset();$("#setupPasswordForm")[0].reset();$("#setEmailFrom")[0].reset();$("#setupQuestionForm")[0].reset();$("#updateTelFrom")[0].reset();$("#updateEmailFrom")[0].reset()}function validate(b,e,c){$(b).next().remove();var a=$('<label class="one1" style="width:180px;">'+e+"</label>");var d=$(b).val().trim();if(d==""){$(b).after(a)}else{if($(b).val().length>c){e="长度不能大于"+c+"位！";a=$('<label class="one1" style="width:180px;">'+e+"</label>");$(b).after(a)}}};