var wait=120;function timeWait(a){if(wait==0){a.removeAttr("disabled");a.val("获取验证码");wait=120}else{a.attr("disabled",true);a.val("重新发送("+wait+")");wait--;setTimeout(function(){timeWait(a)},1000)}}$(function(){var a=/^[a-zA-Z]{1}([a-zA-Z0-9]|[._@]){4,19}$/;$("#oldCode").on("blur",function(){$(this).siblings("label.error").remove();if(this.value==""){$(this).after('<label class="error">请输入旧密码！</label>');return false}}).on("change",function(){$(this).siblings("label.error").remove()});$("#newCode").on("blur",function(){$(this).siblings("label.error").remove();if(this.value==""){$(this).after('<label class="error">请输入新密码！</label>');return false}else{if(!a.exec(this.value)){$(this).after('<label class="error">密码格式错误！</label>');return false}else{$(this).siblings("label.error").remove()}}}).on("change",function(){$(this).siblings("label.error").remove()});$("#confirm").on("blur",function(){var b=$("#newCode").val();$(this).siblings("label.error").remove();if(b!=""&&this.value!=b){$(this).after('<label class="error">两次密码输入不一致！</label>');return false}else{$(this).siblings("label.error").remove()}}).on("change",function(){$(this).siblings("label.error").remove()});$("#sendSMS").on("click",function(){var b=$("#phone").val();var c=$(this).attr("disabled",true);$.ajax({async:true,type:"POST",url:"/sendSMSCaptcha.do",data:{phone:b},success:function(d){if(d=="0000"){timeWait(c)}else{if(d=="0001"){alert("手机号码格式错误！")}else{alert("发送短信异常！")}c.removeAttr("disabled")}}})});$("#form").on("submit",function(){var c=$("#captcha"),e=$("#oldCode"),d=$("#newCode"),b=$("#confirm");if(c.val()==""){c.parent().append('<label class="error">请输入验证码！</label>');return false}if(e.val()==""){e.after('<label class="error">请输入旧密码！</label>');return false}if(d.val()==""){d.after('<label class="error">请输入新密码！</label>');return false}else{if(!a.exec(d.val())){d.after('<label class="error">密码格式错误！</label>');return false}}if(d.val()!=""&&b.val()!=d.val()){b.after('<label class="error">两次密码输入不一致！</label>');return false}$.ajax({async:true,type:"POST",url:"changePassWord.do",data:{captcha:c.val(),oldCode:md5(e.val()),newCode:md5(d.val())},success:function(f){if(f=="timeout"){location.href="/seller/login.do"}else{if(f=="error"){alert("旧密码错误！")}else{if(f=="codeError"){alert("验证码错误！")}else{if(f){location.href="center.do"}else{alert("密码修改异常！")}}}}}});return false})});